clear
clc
%*******************************************
% State Space
A = [-3.785    -19.167   0    0;
   0.469    0.976   0    0;
   0   1   0    0;
   1    0    20    0]

B = [34.409;27.686;0;0]

C = [0 0 0 1]
%*******************************************
% Augmented system

Ag = [ A   zeros(4,1);
       -C  0        ]
Bg = [ B; 0]
Cg = [C 0]

M = [B A; 0 -C]
rank(M)

pause
%*******************************************
P = [-2, -3, -4, -5, -6]

K = acker(Ag, Bg, P)

K1 = K(1:4)
K2 = -K(5)
%*******************************************
% Closed-loop system
Acl = [A - B * K1       B * K2;
        -C                0     ]

Bcl = [zeros(4,1); 1]
Ccl = [C 0]

sys_cl = ss(Acl, Bcl, Ccl, 0)
step(sys_cl)